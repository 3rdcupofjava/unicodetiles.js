<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>Simple Dungeon</title>
	<link href="../unicodetiles/unicodetiles.css" rel="stylesheet" type="text/css" />
	<link href="style.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript" src="../unicodetiles/unicodetiles.js"></script>
	<script type="text/javascript" src="../unicodetiles/input.js"></script>
	<!-- We are extending the simple-dungeon example -->
	<script type="text/javascript" src="simple-dungeon.js"></script> 
	<script type="text/javascript">
		function calculateFov(x, y) {
			var distx = x - pl.x, disty = y - pl.y;
			var maxdist = Math.max(Math.abs(distx), Math.abs(disty));
			var dx = distx / maxdist, dy = disty / maxdist;
			var xx = pl.x, yy = pl.y;
			for (var i = 0; i < maxdist; ++i) {
				if (getDungeonTile(xx,yy).getChar() === "#")
					return false;
				xx += dx; yy += dy;
			}
			return true;
		}

		// Initializes the FOV
		function initFOV() {
			eng.setMaskFunc(calculateFov);
		}
	</script> 
</head>

<body onload="initSimpleDungeon(); initFOV();"><div id="container">

	<p class="centerer">Move around with arrow keys.</p>

	<div class="centerer">
		<div id="game"></div>
	</div>

</div></body>
</html>
